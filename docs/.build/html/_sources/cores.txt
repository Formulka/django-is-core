
Cores
=====

UIRESTModelISCore objects
-------------------------

The UIRESTModelISCore class is the representation of a model in the django-is-core interface. These representations are 
stored in a file named cores.py in your application. We will start with the most common cose when you want to create
three typical views for information system:

  * table view for printing objects
  * view for creating new objects
  * view for editing objects

As example project we use Issue tracker. Firstly for every application you need management of users. We use default 
django user model.

For creating add, edit and table views you must only create file cores.py inside specific application that contains::

    from django.contrib.auth.models import User

    from is_core.main import UIRESTModelISCore

    class UserIsCore(UIRESTModelISCore):
        model = User

There is no obligation for registration. Cores are registered automatically. The result views with previue are:

Table/List
^^^^^^^^^^
image 1


Add
^^^
image 2


Edit
^^^^
image 3


REST
^^^^
But there is created REST resource too. By default on URLs **/api/user/** and **/api/user/{obj_id}** that returns 
object in asked format (HTTP header **Content-type: application/json**).



RESTModelISCore objects
-----------------------

The RESTModelISCore is parent of UIRESTModelISCore. As the name suggests this class is used only for creating REST
resources without UI HTML views. The usage is the same as UIRESTModelISCore::

    from django.contrib.auth.models import User

    from is_core.main import RESTModelISCore

    class RESTUserIsCore(RESTModelISCore):
        model = User


UIModelISCore objects
-----------------------

The RESTModelISCore is the second parent of *UIRESTModelISCore*. It is used for creating only UI views. Because UI views 
needs some REST resources is necessary to specify on which URL is deployed REST resource of model (api_url_name is 
transofmed to URL by django resolve helper)::

    from django.contrib.auth.models import User

    from is_core.main import UIModelISCore

    class UIUserIsCore(UIModelISCore):
        model = User
        api_url_name = 'api-user'


You can specify URL manually::

    class UIUserIsCore(UIModelISCore):
        model = User

        def get_api_url(self, request):
            return '/api/user/'

ISCore hiearchy
---------------

Now we provide detailed description of all ISCore objects. Firstly for better understanding you can see UML class 
diagram of core hiearchy. 

# TODO add diagram


ISCore options
--------------
These options can be applied for all Core objects like *RESTModelISCore*, *UIModelISCore* or *UIRESTModelISCore* (all 
descendants of ISCore class). 

ISCore.abstract
^^^^^^^^^^^^^^^

Variable *abstract* provides way how to create core that is not registered but this class variable is not inherited. 
Let's show an example::

    from django.contrib.auth.models import User

    from is_core.main import RESTModelISCore

    class AbstractUIRESTUserIsCore(RESTModelISCore):
        model = User
        abstract = True
        verbose_name = 'example of abstract user core'

    class UIRESTUserIsCore(AbstractUIRESTUserIsCore):
        pass

First core is not registered. Therefore views and rest resources are not created. But the second view that inherits of 
abstract core is registered. All configuration from parent class is inhered (without abstract variable).

verbose_name, verbose_name_plural
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

These variables are used inside generic views. It can be added to context_data and rendered inside templates. 

ISCore.menu_group
^^^^^^^^^^^^^^^^^

It is necessary have some slug that distinguish one core from another. For this purpose is used variable menu_group.
This variable is used for example to generate URL patterns or menu. Value of the variable is generated automatically 
for cores that is connected to model 

ISCore methods
--------------

ISCore.init_request(request)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Every core views/rest resources calls this method before calling dispatch. You can use it to change request its calling.

ModelISCore options
-------------------

Tne next class that extends ISCore is ModelISCore. All cores that inherits from ModelISCore works as controller over
a model.

ModelISCore.list_actions
^^^^^^^^^^^^^^^^^^^^^^^^

Variable *list_action* contains actions that user can perform via REST or UI. More detailed explanation with example
you find inside **UIRESTModelISCore options** part.

ModelISCore.form_fields
^^^^^^^^^^^^^^^^^^^^^^^

Use the form_fields option to make simple layout changes in the forms on the “add” and “edit” and REST resources pages 
such as showing only a subset of available fields, modifying their order, or grouping them into rows. We will show it
on UIRESTModelISCore. If you want to restrict form fields to *username*, *first_name* and *last_name* the simpliest
way is use:

    from django.contrib.auth.models import User

    from is_core.main import UIRESTModelISCore

    class UserIsCore(UIRESTModelISCore):
        model = User
        form_fields = ('username', 'fist_name', 'last_name')

ModelISCore.form_exclude
^^^^^^^^^^^^^^^^^^^^^^^^

This attribute, if given, should be a list of field names to exclude from the form.

    from django.contrib.auth.models import User

    from is_core.main import UIRESTModelISCore

    class UserIsCore(UIRESTModelISCore):
        model = User
        form_exclude = ('password',)

ModelISCore.form_class
^^^^^^^^^^^^^^^^^^^^^^

If you want to change default form class which is SmartModelForm you can change it with this option. The form is changed
for "add", "edit" views and REST resources too.

ModelISCore.ordering
^^^^^^^^^^^^^^^^^^^^

Option for changing default ordering of model for core.


ModelISCore methods
-------------------

ModelISCore.get_form_fields(request, obj=None)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Use this method to define form fields dynamically or if you want to define different form fields for "add", "edit" view
of REST resources.


ModelISCore.get_form_exclude(request, obj=None)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The oposite to get_form_fields.

ModelISCore.get_form_class(request, obj=None)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Use this method to define form dynamically or if you want to define different form for "add", "edit" view of REST 
resources.

ModelISCore.pre_save_model(request, obj, form, change)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Method per_save_model is called before saving object to database. Body is empty by default.

ModelISCore.post_save_model(request, obj, form, change)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Method post_save_model is called after saving object to database. Body is empty by default.

ModelISCore.save_model(request, obj, form, change)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
You can rewrite this method if you want to change way how is object saved to database. Default body is:

    def save_model(self, request, obj, form, change):
        obj.save()

ModelISCore.pre_delete_model(request, obj)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Method pre_delete_model is called before removing object from database. Body is empty by default.

ModelISCore.post_delete_model(request, obj)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Method post_delete_model is called after removing object from database. Body is empty by default.

ModelISCore.delete_model(request, obj)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
You can rewrite this method if you want to change way how is object removed from database. Default body is:

    def delete_model(self, request, obj):
        obj.delete()

ModelISCore.verbose_name(), ModelISCore.verbose_name_plural()
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Default verbose names of ModelISCore is get from model meta options:

    self.model._meta.verbose_name
    self.model._meta.verbose_name_plural

ModelISCore.menu_group()
^^^^^^^^^^^^^^^^^^^^^^^^

Default menu_group value is get from module name of model (self.model._meta.module_name)

ModelISCore.get_ordering(request)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Use this method if you want to change ordering dynamically.

ModelISCore.get_queryset(request)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Returns model queryset, ordered by defined ordering inside core. You can filter here objects according to user 
permissions.

ModelISCore.preload_queryset(request, qs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The related objects of queryset should sometimes very slow down retrieving data from the database. If you want to 
improve speed of your application use this function to create preloading of related objects.

ModelISCore.get_list_actions(request, obj)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Use this method if you want to change list_actions dynamically.


ModelISCore.get_default_action(request, obj)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Chose default action for object used inside UI and REST. For example default action is action that is performed if you
select row inside table of objects. For table view default action is "open edit view". If you return None no action
is performed by default.


UIModelISCore options
---------------------



UIModelISCore.form_inline_views
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The django-is-core interface has the ability to edit models on the same page as a parent model. These are called 
inlines. The form_inline_views provides simple way 
